CREATE OR REPLACE FUNCTION populate_CMS 
    RETURN string
AS
    CMSpop varchar(1000);

BEGIN

--PHASE 1 - POPULATE SAMPLE REFERENCE DATA

--COUNTRY TABLE
INSERT INTO "CMS"."COUNTRY" (CNTRY_CD,DESCRIPTION) VALUES ('US','UNITED STATES OF AMERICA')
;
INSERT INTO "CMS"."COUNTRY" (CNTRY_CD,DESCRIPTION) VALUES ('CA','CANADA')
;
INSERT INTO "CMS"."COUNTRY" (CNTRY_CD,DESCRIPTION) VALUES ('MX','MEXICO')
;
INSERT INTO "CMS"."COUNTRY" (CNTRY_CD,DESCRIPTION) VALUES ('UK','UNITED KINGDOM')
;

--STATE TABLE
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('AL','ALABAMA','US')
;
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('AK','ALASKA','US')
;
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('AZ','ARIZONA','US')
;
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('AR','ARKANSAS','US')
;
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('CA','CALIFORNIA','US')
;
INSERT INTO "CMS"."STATE" (STATE_CD,DESCRIPTION,CNTRY_CD) VALUES ('ES','EAST SUSSEX','UK')
;

--ORDER STATUS TABLE
INSERT INTO "CMS"."ORDER_STATUS" (ORDR_STAT_CD,DESCRIPTION) VALUES ('P','PENDING SHIPMENT')
;
INSERT INTO "CMS"."ORDER_STATUS" (ORDR_STAT_CD,DESCRIPTION) VALUES ('S','SHIPPED')
;
INSERT INTO "CMS"."ORDER_STATUS" (ORDR_STAT_CD,DESCRIPTION) VALUES ('D','DELIVERED')
;
INSERT INTO "CMS"."ORDER_STATUS" (ORDR_STAT_CD,DESCRIPTION) VALUES ('C','CANCELED')
;
INSERT INTO "CMS"."ORDER_STATUS" (ORDR_STAT_CD,DESCRIPTION) VALUES ('R','RETURNED')
;

--PRODUCTS TABLE
INSERT INTO "CMS"."PRODUCTS" (PRDCT_ID,DESCRIPTION,IN_STOCK_IND,PRICE_PER_UNIT) VALUES (PRODUCT_ID_SEQ.NEXTVAL,'ARGYLE SOCKS','Y',10.00)
;
INSERT INTO "CMS"."PRODUCTS" (PRDCT_ID,DESCRIPTION,IN_STOCK_IND,PRICE_PER_UNIT) VALUES (PRODUCT_ID_SEQ.NEXTVAL,'CANDLE HOLDER','Y',12.00)
;
INSERT INTO "CMS"."PRODUCTS" (PRDCT_ID,DESCRIPTION,IN_STOCK_IND,PRICE_PER_UNIT) VALUES (PRODUCT_ID_SEQ.NEXTVAL,'DATEBOOK','Y',8.00)
;

--PHASE 2 - POPULATE SAMPLE CUSTOMERS
INSERT INTO "CMS"."CUSTOMERS" (CSTMR_ID,CSTMR_LAST_NM,CSTMR_FIRST_NM,CSTMR_MID_INIT,ENTRY_DT,LAST_UPD_DT,CSTMR_TITLE)
VALUES
(CUSTOMER_ID_SEQ.NEXTVAL,'POOH','WINNIE','T',CURRENT_TIMESTAMP(6),CURRENT_TIMESTAMP(6),'MR.')
;
INSERT INTO "CMS"."CUSTOMERS" (CSTMR_ID,CSTMR_LAST_NM,CSTMR_FIRST_NM,CSTMR_MID_INIT,ENTRY_DT,LAST_UPD_DT,CSTMR_TITLE)
VALUES
(CUSTOMER_ID_SEQ.NEXTVAL,'ROO',null,null,CURRENT_TIMESTAMP(6),CURRENT_TIMESTAMP(6),null)
;
INSERT INTO "CMS"."CUSTOMERS" (CSTMR_ID,CSTMR_LAST_NM,CSTMR_FIRST_NM,CSTMR_MID_INIT,ENTRY_DT,LAST_UPD_DT,CSTMR_TITLE)
VALUES
(CUSTOMER_ID_SEQ.NEXTVAL,'TIGGER',null,null,CURRENT_TIMESTAMP(6),CURRENT_TIMESTAMP(6),'HON.')
;
INSERT INTO "CMS"."CUSTOMERS" (CSTMR_ID,CSTMR_LAST_NM,CSTMR_FIRST_NM,CSTMR_MID_INIT,ENTRY_DT,LAST_UPD_DT,CSTMR_TITLE)
VALUES
(CUSTOMER_ID_SEQ.NEXTVAL,'OWL',null,null,CURRENT_TIMESTAMP(6),CURRENT_TIMESTAMP(6),'MR.')
;
INSERT INTO "CMS"."CUSTOMERS" (CSTMR_ID,CSTMR_LAST_NM,CSTMR_FIRST_NM,CSTMR_MID_INIT,ENTRY_DT,LAST_UPD_DT,CSTMR_TITLE)
VALUES
(CUSTOMER_ID_SEQ.NEXTVAL,'ROBIN','CHRISTOPHER',null,CURRENT_TIMESTAMP(6),CURRENT_TIMESTAMP(6),'SIR')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'TREEHOUSE',null,'ASHDOWN FOREST',12345,'Y',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='POOH'),'UK','ES')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'ATTIC','TOY CHEST','HOUSE OF CHRISTOPHER ROBIN',96657,'N',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='POOH'),'US','AL')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'5 MAIN STREET','SUITE 12','DISNEYLAND',20243,'Y',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='TIGGER'),'US','CA')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'123 HAPPY LANE',null,'MILNETOWN',96657,'Y',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='ROBIN'),'US','AL')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'THE ZOO','AUSTRALIA HOUSE','ANIMAL KINGDOM',20243,'Y',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='ROO'),'US','CA')
;

INSERT INTO "CMS"."CUSTOMER_ADDRESS" (ADDR_ID,STREET_LINE_1,STREET_LINE_2,CITY_NM,ZIP_CD,DEFAULT_IND,CSTMR_ID,CNTRY_CD,STATE_CD)
VALUES
(customer_address_id_seq.NEXTVAL,'RAFTERS',null,'SOMEWHERESVILLE',17368,'Y',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='OWL'),'US','AZ')
;


INSERT INTO "CMS"."CUSTOMER_CONTACT" (CNTCT_ID,HOME_PHONE_NBR,MOBILE_PHONE_NBR,EMAIL_ADDR,DEFAULT_IND,PREFERRED_METHOD_CD,CSTMR_ID)
VALUES
(customer_contact_id_seq.NEXTVAL,null,null,'winnie.t.pooh@honeyfans.com','Y','E',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='POOH'))
;

INSERT INTO "CMS"."CUSTOMER_CONTACT" (CNTCT_ID,HOME_PHONE_NBR,MOBILE_PHONE_NBR,EMAIL_ADDR,DEFAULT_IND,PREFERRED_METHOD_CD,CSTMR_ID)
VALUES
(customer_contact_id_seq.NEXTVAL,8884537777,8884531234,'kangaandroo@marsupials.org','Y','H',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='ROO'))
;


INSERT INTO "CMS"."CUSTOMER_CONTACT" (CNTCT_ID,HOME_PHONE_NBR,MOBILE_PHONE_NBR,EMAIL_ADDR,DEFAULT_IND,PREFERRED_METHOD_CD,CSTMR_ID)
VALUES
(customer_contact_id_seq.NEXTVAL,17239869668,null,null,'Y',null,(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='OWL'))
;

INSERT INTO "CMS"."CUSTOMER_CONTACT" (CNTCT_ID,HOME_PHONE_NBR,MOBILE_PHONE_NBR,EMAIL_ADDR,DEFAULT_IND,PREFERRED_METHOD_CD,CSTMR_ID)
VALUES
(customer_contact_id_seq.NEXTVAL,5552334,null,'christherobin@gmail.com','Y',null,(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='ROBIN'))
;

INSERT INTO "CMS"."CUSTOMER_CONTACT" (CNTCT_ID,HOME_PHONE_NBR,MOBILE_PHONE_NBR,EMAIL_ADDR,DEFAULT_IND,PREFERRED_METHOD_CD,CSTMR_ID)
VALUES
(customer_contact_id_seq.NEXTVAL,null,7437437334,null,'Y','M',(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='TIGGER'))
;

INSERT INTO "CMS"."ORDERS" (ORDR_ID,ORDR_DT,CSTMR_ID,ADDR_ID,ORDR_TOTAL_COST,SHIPPING_METHOD_CD,DELIVERY_DT,
CANCEL_IND,COMPLETE_IND,RETURN_IND,ORDR_STAT_CD,CNTCT_ID)
VALUES
(ORDER_ID_SEQ.NEXTVAL,to_date('20180130','YYYYMMDD'),(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='TIGGER'),
(SELECT ADDR_ID FROM CMS.CUSTOMER_ADDRESS WHERE STREET_LINE_1='5 MAIN STREET'),
22.00,'A',to_date('20180203','YYYYMMDD'),'N','Y','N','D',(SELECT CNTCT_ID FROM CMS.CUSTOMER_CONTACT WHERE MOBILE_PHONE_NBR=7437437334))
;

INSERT INTO "CMS"."ORDER_CONTENTS" (ORDR_CONTENTS_ID,ORDR_ID,PRDCT_ID,PRDCT_CNT)
VALUES
(ORDER_CONTENTS_ID_SEQ.NEXTVAL,(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=22.00),
(SELECT PRDCT_ID FROM CMS.PRODUCTS WHERE DESCRIPTION='ARGYLE SOCKS'),1)
;

INSERT INTO "CMS"."ORDER_CONTENTS" (ORDR_CONTENTS_ID,ORDR_ID,PRDCT_ID,PRDCT_CNT)
VALUES
(ORDER_CONTENTS_ID_SEQ.NEXTVAL,(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=22.00),
(SELECT PRDCT_ID FROM CMS.PRODUCTS WHERE DESCRIPTION='CANDLE HOLDER'),1)
;

INSERT INTO "CMS"."ORDER_TRACKING" (ORDR_HIST_ID,STAT_DT,ORDR_ID,ORDR_STAT_CD,NOTES)
VALUES
(ORDER_TRACKING_ID_SEQ.NEXTVAL,to_date('20180130','YYYYMMDD'),(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=22.00),
'P',null)
;

INSERT INTO "CMS"."ORDER_TRACKING" (ORDR_HIST_ID,STAT_DT,ORDR_ID,ORDR_STAT_CD,NOTES)
VALUES
(ORDER_TRACKING_ID_SEQ.NEXTVAL,to_date('20180131','YYYYMMDD'),(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=22.00),
'S',null)
;

INSERT INTO "CMS"."ORDER_TRACKING" (ORDR_HIST_ID,STAT_DT,ORDR_ID,ORDR_STAT_CD,NOTES)
VALUES
(ORDER_TRACKING_ID_SEQ.NEXTVAL,to_date('20180203','YYYYMMDD'),(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=22.00),
'D',null)
;

INSERT INTO "CMS"."ORDERS" (ORDR_ID,ORDR_DT,CSTMR_ID,ADDR_ID,ORDR_TOTAL_COST,SHIPPING_METHOD_CD,DELIVERY_DT,
CANCEL_IND,COMPLETE_IND,RETURN_IND,ORDR_STAT_CD,CNTCT_ID)
VALUES
(ORDER_ID_SEQ.NEXTVAL,to_date('20180208','YYYYMMDD'),(SELECT CSTMR_ID FROM CMS.CUSTOMERS WHERE CSTMR_LAST_NM='ROBIN'),
(SELECT ADDR_ID FROM CMS.CUSTOMER_ADDRESS WHERE STREET_LINE_1='123 HAPPY LANE'),
32.00,'A',null,'N','N','N','P',(SELECT CNTCT_ID FROM CMS.CUSTOMER_CONTACT WHERE EMAIL_ADDR='christherobin@gmail.com'))
;

INSERT INTO "CMS"."ORDER_CONTENTS" (ORDR_CONTENTS_ID,ORDR_ID,PRDCT_ID,PRDCT_CNT)
VALUES
(ORDER_CONTENTS_ID_SEQ.NEXTVAL,(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=32.00),
(SELECT PRDCT_ID FROM CMS.PRODUCTS WHERE DESCRIPTION='DATEBOOK'),4)
;


INSERT INTO "CMS"."ORDER_TRACKING" (ORDR_HIST_ID,STAT_DT,ORDR_ID,ORDR_STAT_CD,NOTES)
VALUES
(ORDER_TRACKING_ID_SEQ.NEXTVAL,to_date('20180208','YYYYMMDD'),(SELECT ORDR_ID FROM CMS.ORDERS WHERE ORDR_TOTAL_COST=32.00),
'P','GIFT WRAP')
;

CMSpop := 'CMS Population Complete';

RETURN CMSpop;

EXCEPTION
WHEN OTHERS THEN
   dbms_output.put_line('populate_CMS has encountered an unexpected error - '||SQLERRM);     
END;
/